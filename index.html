<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Weather Dashboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Compressed CSS -->
    <link rel="stylesheet" href="./develop/style/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.6.3/dist/css/foundation.min.css" integrity="sha256-ogmFxjqiTMnZhxCqVmcqTvjfe1Y/ec4WaRj/aQPvn+I=" crossorigin="anonymous">

    <!-- Compressed JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.6.3/dist/js/foundation.min.js" integrity="sha256-pRF3zifJRA9jXGv++b06qwtSqX1byFQOLjqa2PTEb2o=" crossorigin="anonymous"></script>
</head>
<body>
    
    
    <div class="weatherContainer">
        <div class="grid-y medium-grid-frame">
            <div class="cell shrink header medium-cell-block-container">
              <h1>Grid Frame Header</h1>
              <div class="grid-x grid-padding-x">
                <div class="medium-4 cell">
                    <div class="input-group">
                        <span class="input-group-label">City</span>
                        <input class="input-group-field" id="citySearchID" type="text">
                        <div class="input-group-button">
                          <input type="submit" id="citySearchBtn" class="button" value="Search">
                        </div>
                      </div>
                  </div>
                <div class="cell medium-4 medium-cell-block">
                  <p style="width:80vw;">A medium 4 cell block... on medium this content should overflow and let you horizontally scroll across... one might use this for an array of options</p>
                </div>
                <div class="cell medium-4">
                  A medium 4 cell
                </div>
              </div>
            </div>
            <div class="cell medium-auto medium-cell-block-container">
              <div class="grid-x grid-padding-x">
                <div class="cell medium-4 medium-cell-block-y" id="savedCitiesSidebar">
                  <h2>Your Cities</h2>
                
                </div>
                <div class="cell medium-8 medium-cell-block-y" id="storedCities">
                  <h2 id="cityName">City</h2>
                  <p id="tempSlot">Temperature</p>
                  <p id="humiditySlot">Humidity</p>
                  <p id="windSpeedSlot">Wind Speed</p>
                </div>
              </div>
            </div>
            <div class="cell medium-auto medium-cell-block-container" id="forecastBar">
              <div class="grid-x grid-padding-x">
                <h5>5 Day Forecast</h5>
              </div>
            </div>
            <div class="cell shrink footer">
              <h3>Here's my footer</h3>
            </div>
          </div>    

    <!--TO DO-->
    <!--
        Aqcuire CSS Framework - FOUNDATION
        Acquire Weather API - YES
        Create Critical HTML Elements
        Write function for AJAX Call
        Write JQuery to set new elements
        Add eventlisteners (city buttons and search input)
        I will need to make three seperate API calls- one for weather, one for five day, and one for UV
        Set cities searched to localstorage, and then generate those calls again when the page is reloaded
    -->    


        
    </div>

    <script>
        const APIKey = "43b5b86a3681230a45961cc32737a765";
        const citySearch = $('#citySearchID');
        const savedCitiesSidebar = $('#savedCitiesSidebar');
        let cityName = $("#cityName");
        let tempSlot = $("#tempSlot");
        let humiditySlot = $("#humiditySlot");
        let windSpeedSlot = $("#windSpeedSlot");
        var searchedCities = [];

        getSavedCities();

        $("#citySearchBtn").click(function (){
        
          const city = (citySearch).val();
          saveCity(city);
          getWeather(city);
          getForecast(city);
        })

        $(".cityBtn").on("click", function () {
            getWeather((this).innerHTML);
            getForecast((this).innerHTML);
        });

        function getWeather(city){
          let queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + city + "&units=imperial&appid=" + APIKey;
          $.ajax({
            url: queryURL,
            method: "GET"
            }).then(function(response) {
                (cityName).text(response.name)
                tempSlot.text("Temperature: " + (response.main.temp));
                humiditySlot.text("Humidity: " + response.main.humidity);
                windSpeedSlot.text("Wind Speed: " + response.wind.speed);
            })
        }

        function saveCity (city) {
          if (searchedCities.indexOf(city) === -1) {
                searchedCities.push(city);
                makeCityBtn(city);
                } else {
                  console.log("already got 'im!")
                  }
          window.localStorage.setItem("cities", JSON.stringify(searchedCities))        
        }

        function getSavedCities () {
          let savedCities = JSON.parse(localStorage.getItem('cities'));
          for (let i = 0; i < savedCities.length; i++) {
            searchedCities.push(savedCities[i]);
            makeCityBtn(savedCities[i]);  
          }
        };
               
        function makeCityBtn (city) {
          $("<button>").text(city).addClass('success button cityBtn').appendTo(savedCitiesSidebar);
        }

        function getForecast (city) {
          console.log(city);
          let queryURL = "https://api.openweathermap.org/data/2.5/forecast/daily?id=" + city + "&cnt=" + 5 + "&units=imperial&appid=" + APIKey;
          $.ajax({
            url: queryURL,
            method: "GET"
            }).then(function(response) {
              console.log(response);
          })
        }
      









        //api.openweathermap.org/data/2.5/forecast/daily?id={city ID}&cnt={cnt}&appid={API key}










    </script>
</body>
</html>




